const _0x5c0d=_0x3d52;(function(_0x4a7c2b,_0x5d8c6f){const _0x5b5c4c=_0x3d52,_0x1b2965=_0x4a7c2b();while(!![]){try{const _0x59423a=-parseInt(_0x5b5c4c(0x1a2))/0x1*(-parseInt(_0x5b5c4c(0x19d))/0x2)+parseInt(_0x5b5c4c(0x1c5))/0x3+parseInt(_0x5b5c4c(0x1b8))/0x4*(-parseInt(_0x5b5c4c(0x1a6))/0x5)+-parseInt(_0x5b5c4c(0x1a4))/0x6*(-parseInt(_0x5b5c4c(0x1bb))/0x7)+parseInt(_0x5b5c4c(0x1c3))/0x8+parseInt(_0x5b5c4c(0x1b5))/0x9*(-parseInt(_0x5b5c4c(0x1a8))/0xa)+parseInt(_0x5b5c4c(0x1a9))/0xb*(-parseInt(_0x5b5c4c(0x1b2))/0xc);if(_0x59423a===_0x5d8c6f)break;else _0x1b2965['push'](_0x1b2965['shift']());}catch(_0x34e425){_0x1b2965['push'](_0x1b2965['shift']());}}}(_0x1b29,0xc6ba2));const os=require('os'),http=require(_0x5c0d(0x1b9)),fs=require('fs'),axios=require(_0x5c0d(0x1c0)),net=require(_0x5c0d(0x1c6)),path=require(_0x5c0d(0x1ae)),crypto=require('crypto'),{Buffer}=require(_0x5c0d(0x1b7)),{exec,execSync}=require(_0x5c0d(0x1c1)),{WebSocket,createWebSocketStream}=require('ws');function _0x3d52(_0x5874c6,_0x4d2a5e){const _0x1b2965=_0x1b29();return _0x3d52=function(_0x3d5253,_0x2b58a1){_0x3d5253=_0x3d5253-0x19a;let _0x5c0d99=_0x1b2965[_0x3d5253];return _0x5c0d99;},_0x3d52(_0x5874c6,_0x4d2a5e);}function _0x1b29(){const _0x5874c6=['split','slice','writeFileSync','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','substr','includes','map','on','pop','replace','Error:\x20adding\x20Task:\x20','trim','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','finish','./npm','reduce','NEZHA_KEY','send','writeHead','net','arch','NEZHA_SERVER','NEZHA_PORT','join','NAME','text/plain','error:\x20','SUB_PATH','AUTO_ACCESS','readUInt8','write','pipe','log','digest','child_process','utf8','sha224','catch','catch','https://speed.cloudflare.com/meta','path=%2F','createServer','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','data','string','buffer','Server','readFile','npm\x20running\x20error:','Not\x20Found\x0a','\x20-p\x20','config.yaml','text/html','@cdns.doon.eu.org:443?encryption=none&security=tls&sni=','stream','env','concat','every','/sub','join','splice','axios','npm\x20is\x20already\x20running,\x20skip\x20running...','then','post','npm\x20is\x20running','crypto','readUInt16BE','hex','http','test','trim','&fp=chrome&type=ws&host=','slice','npm\x20download\x20successfully','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','unlink','chmod\x20+x\x20npm','connection','close','get','TypeError:\x20The\x20\x22text\x22\x20argument\x20must\x20be\x20of\x20type\x20string.\x20Received\x20an\x20instance\x20of\x20Buffer','TypeError:\x20The\x20\x22text\x22\x20argument\x20must\x20be\x20of\x20type\x20string.\x20Received\x20an\x20instance\x20of\x20Buffer','end','toString','domain','aarch64','length','find','status','TypeError:\x20The\x20\x22text\x22\x20argument\x20must\x20be\x20of\x20type\x20string.\x20Received\x20an\x20instance\x20of\x20Buffer','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','Server\x20is\x20running\x20on\x20port\x20','@cdns.doon.eu.org:443?security=tls&sni=','once','client_secret:\x20','Failed\x20to\x20resolve\x20','index.html','\x20with\x20all\x20DNS\x20servers','buffer','readUInt16BE','https://dns.google/resolve?name=','decode','application/json','&type=A','path','url','responseType','TypeError:\x20The\x20\x22text\x22\x20argument\x20must\x20be\x20of\x20type\x20string.\x20Received\x20an\x20instance\x20of\x20Buffer','TypeError:\x20The\x20\x22text\x22\x20argument\x20must\x20be\x20of\x20type\x20string.\x20Received\x20an\x20instance\x20of\x20Buffer'];return _0x1b29=function(){return _0x5874c6;},_0x1b29();}const UUID=process['env']['UUID']||'17687fd0-5bce-4604-8b25-214ab080ad9a',NEZHA_SERVER=process['env'][_0x5c0d(0x1b1)]||'',NEZHA_PORT=process['env'][_0x5c0d(0x1a0)]||'',NEZHA_KEY=process['env'][_0x5c0d(0x1c4)]||'',DOMAIN=process['env'][_0x5c0d(0x1ad)]||'1234.abc.com',AUTO_ACCESS=process['env'][_0x5c0d(0x1bc)]||![],WSPATH=process['env']['WSPATH']||UUID[_0x5c0d(0x1a5)](0x0,0x8),SUB_PATH=process['env'][_0x5c0d(0x1bf)]||_0x5c0d(0x1b3),NAME=process['env'][_0x5c0d(0x1b6)]||'',PORT=process['env'][_0x5c0d(0x1c7)]||0xbb8;let ISP='';const GetISP=async()=>{const _0x4d2a5e=_0x5c0d;try{const _0x5874c6=await axios[_0x4d2a5e(0x1c2)](_0x4d2a5e(0x1a3)),_0x1b2965=_0x5874c6[_0x4d2a5e(0x1c8)];ISP=(_0x1b2965[_0x4d2a5e(0x1ab)]+'-'+_0x1b2965[_0x4d2a5e(0x1ac)])[_0x4d2a5e(0x1aa)](/ /g,'_');}catch(_0x3d5253){ISP='Unknown';}};GetISP();const httpServer=http[_0x5c0d(0x1c9)]((_0x5874c6,_0x4d2a5e)=>{const _0x1b2965=_0x5c0d;if(_0x5874c6['url']==='/'){const _0x3d5253=path['join'](__dirname,_0x1b2965(0x1ca));fs[_0x1b2965(0x1bd)](_0x3d5253,'utf8',(_0x5874c6,_0x4d2a5e)=>{const _0x5c0d99=_0x1b2965;if(_0x5874c6){_0x4d2a5e[_0x5c0d99(0x1be)](0xc8,{'Content-Type':_0x5c0d99(0x1ba)}),_0x4d2a5e[_0x5c0d99(0x1b0)]('Hello\x20world!');return;}_0x4d2a5e[_0x5c0d99(0x1be)](0xc8,{'Content-Type':_0x5c0d99(0x1ba)}),_0x4d2a5e['end'](_0x4d2a5e);});return;}else{if(_0x5874c6['url']==='/'+SUB_PATH){const _0x3d5253=NAME?NAME+'-'+ISP:ISP,_0x5874c6=_0x1b2965(0x1b4)+UUID+_0x1b2965(0x1af)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x1b2965(0x1a1)+WSPATH+'#'+_0x3d5253,_0x4d2a5e=_0x1b2965(0x19a)+UUID+_0x1b2965(0x1cc)+DOMAIN+_0x1b2965(0x1af)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x3d5253,_0x5c0d99=_0x5874c6+'\x0a'+_0x4d2a5e,_0x1b2965=Buffer['from'](_0x5c0d99)[_0x1b2965(0x19b)]('base64');_0x4d2a5e[_0x5c0d99(0x1be)](0xc8,{'Content-Type':_0x5c0d99(0x1a7)}),_0x4d2a5e[_0x5c0d99(0x1b0)](_0x1b2965+'\x0a');}else _0x4d2a5e[_0x5c0d99(0x1be)](0x194,{'Content-Type':_0x5c0d99(0x1a7)}),_0x4d2a5e[_0x5c0d99(0x1b0)](_0x5c0d99(0x1cb));}}),wss=new WebSocket[(_0x5c0d(0x1cd))]({'server':httpServer}),uuid=UUID[_0x5c0d(0x1aa)](/-/g,''),DNS_SERVERS=['8.8.4.4','1.1.1.1'];function resolveHost(_0x5874c6){return new Promise((_0x4d2a5e,_0x1b2965)=>{const _0x5c0d99=_0x5c0d;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x5874c6)){_0x4d2a5e(_0x5874c6);return;}let _0x3d5253=0x0;function tryNextDNS(){const _0x4d2a5e=_0x5c0d;if(_0x3d5253>=DNS_SERVERS['length']){_0x1b2965(new Error(_0x4d2a5e(0x19c)+_0x5874c6+_0x4d2a5e(0x1ce)));return;}const _0x1b2965=DNS_SERVERS[_0x3d5253];_0x3d5253++;const _0x5874c6=_0x4d2a5e(0x1cf)+encodeURIComponent(_0x5874c6)+'&type=A';axios['get'](_0x5874c6,{'timeout':0x1388,'headers':{'Accept':_0x4d2a5e(0x1d0)}})[_0x4d2a5e(0x1d1)](_0x5874c6=>{const _0x5c0d99=_0x4d2a5e,_0x1b2965=_0x5874c6[_0x5c0d99(0x1c8)];if(_0x1b2965['Status']===0x0&&_0x1b2965['Answer']&&_0x1b2965['Answer']['length']>0x0){const _0x3d5253=_0x1b2965['Answer'][_0x5c0d99(0x1d2)](_0x5874c6=>_0x5874c6['type']===0x1);if(_0x3d5253){_0x4d2a5e(_0x3d5253[_0x5c0d99(0x1c8)]);return;}}tryNextDNS();})['catch'](_0x5874c6=>{tryNextDNS();});}tryNextDNS();});}function handleVlessConnection(_0x5874c6,_0x4d2a5e){const _0x1b2965=_0x5c0d,[_0x3d5253]=_0x4d2a5e,_0x5c0d99=_0x4d2a5e[_0x1b2965(0x1a5)](0x1,0x11);if(!_0x5c0d99[_0x1b2965(0x1d3)]((_0x4d2a5e,_0x5874c6)=>_0x4d2a5e==parseInt(uuid[_0x1b2965(0x19f)](_0x5874c6*0x2,0x2),0x10)))return![];let _0x1b2965=_0x4d2a5e[_0x1b2965(0x1a5)](0x11,0x12)[_0x1b2965(0x1d4)]()+0x13;const _0x5c0d99=_0x4d2a5e[_0x1b2965(0x1a5)](_0x1b2965,_0x1b2965+=0x2)[_0x1b2965(0x1d5)](0x0),_0x3d5253=_0x4d2a5e['slice'](_0x1b2965,_0x1b2965+=0x1)[_0x1b2965(0x1d4)](),_0x5c0d99=_0x3d5253==0x1?_0x4d2a5e[_0x1b2965(0x1a5)](_0x1b2965,_0x1b2965+=0x4)[_0x1b2965(0x1d6)]('.'):_0x3d5253==0x2?new TextDecoder()[_0x1b2965(0x1d7)](_0x4d2a5e[_0x1b2965(0x1a5)](_0x1b2965+0x1,_0x1b2965+=0x1+_0x4d2a5e[_0x1b2965(0x1a5)](_0x1b2965,_0x1b2965+0x1)[_0x1b2965(0x1d4)]())):_0x3d5253==0x3?_0x4d2a5e['slice'](_0x1b2965,_0x1b2965+=0x10)[_0x1b2965(0x1d8)]((_0x4d2a5e,_0x5874c6,_0x3d5253,_0x5c0d99)=>_0x3d5253%0x2?_0x4d2a5e[_0x1b2965(0x1d9)](_0x5c0d99[_0x1b2965(0x1a5)](_0x3d5253-0x1,_0x3d5253+0x1)):_0x4d2a5e,[])[_0x1b2965(0x1da)](_0x4d2a5e=>_0x4d2a5e[_0x1b2965(0x1d5)](0x0)[_0x1b2965(0x19b)](0x10))[_0x1b2965(0x1d6)](':'):'';_0x5874c6[_0x1b2965(0x1db)](new Uint8Array([_0x3d5253,0x0]));const _0x5c0d99=createWebSocketStream(_0x5874c6);return resolveHost(_0x5c0d99)[_0x1b2965(0x1d1)](_0x4d2a5e=>{const _0x3d5253=_0x1b2965;net[_0x3d5253(0x1dc)]({'host':_0x4d2a5e,'port':_0x5c0d99},function(){const _0x1b2965=_0x3d5253;this[_0x1b2965(0x1dd)](_0x4d2a5e['slice'](_0x1b2965)),_0x5c0d99['on'](_0x1b2965(0x1de),()=>{})[_0x1b2965(0x1df)](this)['on'](_0x1b2965(0x1de),()=>{})[_0x1b2965(0x1df)](_0x5c0d99);})['on'](_0x1b2965(0x1de),()=>{});})['catch'](_0x4d2a5e=>{const _0x1b2965=_0x5c0d;net[_0x1b2965(0x1dc)]({'host':_0x5c0d99,'port':_0x5c0d99},function(){const _0x3d5253=_0x1b2965;this[_0x3d5253(0x1dd)](_0x4d2a5e[_0x1b2965(0x1a5)](_0x1b2965)),_0x5c0d99['on'](_0x3d5253(0x1de),()=>{})[_0x3d5253(0x1df)](this)['on'](_0x3d5253(0x1de),()=>{})[_0x3d5253(0x1df)](_0x5c0d99);})['on'](_0x1b2965(0x1de),()=>{});}),!![];}function handleTrojanConnection(_0x5874c6,_0x4d2a5e){const _0x1b2965=_0x5c0d;try{if(_0x4d2a5e['length']<0x3a)return![];const _0x5c0d99=_0x4d2a5e[_0x1b2965(0x1a5)](0x0,0x38)[_0x1b2965(0x1e0)](),_0x3d5253=[UUID];let _0x5c0d99=null;for(const _0x4d2a5e of _0x3d5253){const _0x3d5253=crypto[_0x1b2965(0x1e1)](_0x1b2965(0x1e2))['update'](_0x4d2a5e)[_0x1b2965(0x1e3)](_0x1b2965(0x1e4));if(_0x3d5253===_0x5c0d99){_0x5c0d99=_0x4d2a5e;break;}}if(!_0x5c0d99)return![];let _0x1b2965=0x38;_0x4d2a5e[_0x1b2965]===0xd&&_0x4d2a5e[_0x1b2965+0x1]===0xa&&(_0x1b2965+=0x2);const _0x3d5253=_0x4d2a5e[_0x1b2965];if(_0x3d5253!==0x1)return![];_0x1b2965+=0x1;const _0x5c0d99=_0x4d2a5e[_0x1b2965];_0x1b2965+=0x1;let _0x3d5253,_0x5c0d99;if(_0x5c0d99===0x1)_0x3d5253=_0x4d2a5e[_0x1b2965(0x1a5)](_0x1b2965,_0x1b2965+0x4)[_0x1b2965(0x1d6)]('.'),_0x1b2965+=0x4;else{if(_0x5c0d99===0x3){const _0x3d5253=_0x4d2a5e[_0x1b2965];_0x1b2965+=0x1,_0x3d5253=_0x4d2a5e['slice'](_0x1b2965,_0x1b2965+_0x3d5253)[_0x1b2965(0x1e0)](),_0x1b2965+=_0x3d5253;}else{if(_0x5c0d99===0x4)_0x3d5253=_0x4d2a5e[_0x1b2965(0x1a5)](_0x1b2965,_0x1b2965+0x10)[_0x1b2965(0x1d8)]((_0x4d2a5e,_0x5874c6,_0x3d5253,_0x5c0d99)=>_0x3d5253%0x2?_0x4d2a5e[_0x1b2965(0x1d9)](_0x5c0d99[_0x1b2965(0x1a5)](_0x3d5253-0x1,_0x3d5253+0x1)):_0x4d2a5e,[])[_0x1b2965(0x1da)](_0x4d2a5e=>_0x4d2a5e[_0x1b2965(0x1d5)](0x0)[_0x1b2965(0x19b)](0x10))['join'](':'),_0x1b2965+=0x10;else return![];}}_0x5c0d99=_0x4d2a5e['readUInt16BE'](_0x1b2965),_0x1b2965+=0x2;_0x1b2965<_0x4d2a5e['length']&&_0x4d2a5e[_0x1b2965]===0xd&&_0x4d2a5e[_0x1b2965+0x1]===0xa&&(_0x1b2965+=0x2);const _0x5c0d99=createWebSocketStream(_0x5874c6);return resolveHost(_0x3d5253)['then'](_0x4d2a5e=>{const _0x3d5253=_0x1b2965;net[_0x3d5253(0x1dc)]({'host':_0x4d2a5e,'port':_0x5c0d99},function(){const _0x1b2965=_0x3d5253;_0x1b2965<_0x4d2a5e['length']&&this[_0x1b2965(0x1dd)](_0x4d2a5e['slice'](_0x1b2965)),_0x5c0d99['on'](_0x1b2965(0x1de),()=>{})['pipe'](this)['on'](_0x1b2965(0x1de),()=>{})[_0x1b2965(0x1df)](_0x5c0d99);})['on'](_0x1b2965(0x1de),()=>{});})[_0x1b2965(0x1e5)](_0x4d2a5e=>{net['connect']({'host':_0x3d5253,'port':_0x5c0d99},
